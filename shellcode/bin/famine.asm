; Listing generated by Microsoft (R) Optimizing Compiler Version 19.41.34120.0 

include listing.inc

INCLUDELIB OLDNAMES

PUBLIC	Run
PUBLIC	GetProcAddressWithHash
;	COMDAT pdata
pdata	SEGMENT
$pdata$Run DD	imagerel $LN4
	DD	imagerel $LN4+282
	DD	imagerel $unwind$Run
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$GetProcAddressWithHash DD imagerel $LN37
	DD	imagerel $LN37+263
	DD	imagerel $unwind$GetProcAddressWithHash
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$GetProcAddressWithHash DD 091501H
	DD	057415H
	DD	046415H
	DD	035415H
	DD	023415H
	DD	0e015H
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$Run DD	071701H
	DD	0197417H
	DD	0183417H
	DD	0140117H
	DD	0500bH
xdata	ENDS
; Function compile flags: /Ogspy
;	COMDAT GetProcAddressWithHash
_TEXT	SEGMENT
dwModuleFunctionHash$ = 16
GetProcAddressWithHash PROC				; COMDAT
; File C:\Users\Administrator\Desktop\PE-Injection\shellcode\src\GetProcAddressWithHash.h
; Line 32
$LN37:
	mov	rax, rsp
	mov	QWORD PTR [rax+8], rbx
	mov	QWORD PTR [rax+16], rbp
	mov	QWORD PTR [rax+24], rsi
	mov	QWORD PTR [rax+32], rdi
	push	r14
; Line 52
	mov	rax, QWORD PTR gs:96
	mov	ebp, ecx
; Line 61
	xor	r14d, r14d
	mov	rdx, QWORD PTR [rax+24]
	mov	r9, QWORD PTR [rdx+16]
	jmp	$LN35@GetProcAdd
$LL2@GetProcAdd:
; Line 64
	mov	r8, QWORD PTR [r9+48]
	mov	edx, r14d
; Line 65
	movups	xmm0, XMMWORD PTR [r9+88]
; Line 70
	mov	r9, QWORD PTR [r9]
	movsxd	rax, DWORD PTR [r8+60]
	mov	r10d, DWORD PTR [rax+r8+136]
; Line 73
	test	r10d, r10d
	je	SHORT $LN35@GetProcAdd
; Line 79
	movq	rax, xmm0
	shr	rax, 16
	cmp	r14w, ax
	jae	SHORT $LN5@GetProcAdd
	psrldq	xmm0, 8
	movq	r11, xmm0
	movzx	ebx, ax
$LL6@GetProcAdd:
; Line 85
	movsx	ecx, BYTE PTR [r11]
	ror	edx, 13
	add	ecx, edx
	cmp	BYTE PTR [r11], 97			; 00000061H
	lea	edx, DWORD PTR [rcx-32]
	cmovl	edx, ecx
	inc	r11
	sub	rbx, 1
	jne	SHORT $LL6@GetProcAdd
$LN5@GetProcAdd:
; Line 95
	add	r10, r8
; Line 100
	mov	r11d, r14d
	mov	edi, DWORD PTR [r10+32]
	add	rdi, r8
	cmp	DWORD PTR [r10+24], r14d
	jbe	SHORT $LN35@GetProcAdd
$LL9@GetProcAdd:
; Line 103
	mov	esi, DWORD PTR [rdi]
	mov	ebx, r14d
	add	rsi, r8
; Line 104
	lea	rdi, QWORD PTR [rdi+4]
$LL12@GetProcAdd:
; Line 111
	movsx	ecx, BYTE PTR [rsi]
; Line 112
	inc	rsi
	ror	ebx, 13
	add	ebx, ecx
; Line 113
	test	cl, cl
	jne	SHORT $LL12@GetProcAdd
; Line 115
	lea	eax, DWORD PTR [rbx+rdx]
; Line 117
	cmp	eax, ebp
	je	SHORT $LN23@GetProcAdd
; Line 100
	inc	r11d
	cmp	r11d, DWORD PTR [r10+24]
	jb	SHORT $LL9@GetProcAdd
$LN35@GetProcAdd:
; Line 61
	cmp	QWORD PTR [r9+48], r14
	jne	$LL2@GetProcAdd
; Line 126
	xor	eax, eax
$LN1@GetProcAdd:
; Line 127
	mov	rbx, QWORD PTR [rsp+16]
	mov	rbp, QWORD PTR [rsp+24]
	mov	rsi, QWORD PTR [rsp+32]
	mov	rdi, QWORD PTR [rsp+40]
	pop	r14
	ret	0
$LN23@GetProcAdd:
; Line 119
	mov	eax, DWORD PTR [r10+36]
	lea	ecx, DWORD PTR [r11+r11]
	add	rax, r8
; Line 120
	movzx	edx, WORD PTR [rcx+rax]
	mov	ecx, DWORD PTR [r10+28]
	add	rcx, r8
	mov	eax, DWORD PTR [rcx+rdx*4]
	add	rax, r8
	jmp	SHORT $LN1@GetProcAdd
GetProcAddressWithHash ENDP
_TEXT	ENDS
; Function compile flags: /Ogspy
;	COMDAT Run
_TEXT	SEGMENT
sMessageBoxW$ = 32
szMsgTitle$ = 48
uString$ = 64
aString$ = 80
sUser32$ = 96
szMsgContent$ = 120
pMessageBoxW$ = 176
hUser32$ = 184
Run	PROC						; COMDAT
; File C:\Users\Administrator\Desktop\PE-Injection\shellcode\src\famine.c
; Line 23
$LN4:
	mov	QWORD PTR [rsp+24], rbx
	mov	QWORD PTR [rsp+32], rdi
	push	rbp
	lea	rbp, QWORD PTR [rsp-87]
	sub	rsp, 160				; 000000a0H
; Line 30
	xor	ebx, ebx
; Line 39
	mov	DWORD PTR sUser32$[rbp-73], 7536757	; 00730075H
; Line 49
	mov	ecx, -1111516141			; bdbf9c13H
	mov	QWORD PTR pMessageBoxW$[rbp-73], rbx
	mov	DWORD PTR uString$[rbp-69], ebx
	mov	DWORD PTR aString$[rbp-69], ebx
	mov	WORD PTR szMsgContent$[rbp-49], bx
	mov	DWORD PTR sUser32$[rbp-69], 7471205	; 00720065H
	mov	DWORD PTR sUser32$[rbp-65], 3276851	; 00320033H
	mov	DWORD PTR sUser32$[rbp-61], 6553646	; 0064002eH
	mov	DWORD PTR sUser32$[rbp-57], 7077996	; 006c006cH
	mov	DWORD PTR sMessageBoxW$[rbp-73], 1936942413 ; 7373654dH
	mov	DWORD PTR sMessageBoxW$[rbp-69], 1113941857 ; 42656761H
	mov	DWORD PTR sMessageBoxW$[rbp-65], 5732463 ; 0057786fH
	mov	DWORD PTR szMsgContent$[rbp-73], 6619208 ; 00650048H
	mov	DWORD PTR szMsgContent$[rbp-69], 7077996 ; 006c006cH
	mov	DWORD PTR szMsgContent$[rbp-65], 2097263 ; 0020006fH
	mov	DWORD PTR szMsgContent$[rbp-61], 7274583 ; 006f0057H
	mov	DWORD PTR szMsgContent$[rbp-57], 7078002 ; 006c0072H
	mov	DWORD PTR szMsgContent$[rbp-53], 2162788 ; 00210064H
	mov	DWORD PTR szMsgTitle$[rbp-73], 6619204	; 00650044H
	mov	DWORD PTR szMsgTitle$[rbp-69], 7274605	; 006f006dH
	mov	DWORD PTR szMsgTitle$[rbp-65], 33	; 00000021H
	call	GetProcAddressWithHash
; Line 50
	mov	ecx, 1591296437				; 5ed941b5H
	mov	rbx, rax
	call	GetProcAddressWithHash
	mov	rdi, rax
; Line 54
	mov	DWORD PTR uString$[rbp-73], 1310740	; 00140014H
	lea	rax, QWORD PTR sUser32$[rbp-73]
; Line 56
	xor	edx, edx
	lea	r9, QWORD PTR hUser32$[rbp-73]
	mov	QWORD PTR uString$[rbp-65], rax
	lea	r8, QWORD PTR uString$[rbp-73]
	xor	ecx, ecx
	call	rbx
; Line 59
	mov	rcx, QWORD PTR hUser32$[rbp-73]
	lea	rax, QWORD PTR sMessageBoxW$[rbp-73]
	xor	r8d, r8d
	mov	QWORD PTR aString$[rbp-65], rax
	lea	r9, QWORD PTR pMessageBoxW$[rbp-73]
	mov	DWORD PTR aString$[rbp-73], 786444	; 000c000cH
	lea	rdx, QWORD PTR aString$[rbp-73]
	call	rdi
; Line 64
	xor	r9d, r9d
	lea	r8, QWORD PTR szMsgTitle$[rbp-73]
	lea	rdx, QWORD PTR szMsgContent$[rbp-73]
	xor	ecx, ecx
	call	QWORD PTR pMessageBoxW$[rbp-73]
; Line 65
	lea	r11, QWORD PTR [rsp+160]
	mov	rbx, QWORD PTR [r11+32]
	mov	rdi, QWORD PTR [r11+40]
	mov	rsp, r11
	pop	rbp
	ret	0
Run	ENDP
_TEXT	ENDS
END
